
set(CMAKE_CUDA_COMPILER "/usr/local/cuda-11.0/bin/nvcc")
project(tensor-compiler-gpu LANGUAGES C CXX CUDA)
cmake_minimum_required(VERSION 3.5)
include(CheckLanguage)
check_language(CUDA)
# set(CMAKE_C_COMPILER "/usr/local/cuda-10.0/bin//nvcc")
# set(CMAKE_CXX_COMPILER "/usr/local/cuda-10.0/bin//nvcc")
set(CMAKE_CUDA_ARCHITECTURES "70;75;80")

include_directories("/usr/local/cuda-11.0/include" "/usr/local/cudnn-11.2/include")
link_directories("/usr/local/cuda-11.0/lib64" "/usr/local/cudnn-11.2/lib64")

# add_compile_options(-fno-stack-protector)

add_executable(reduce_using_reg src/reduce_using_reg.cu)
add_executable(add src/Add.cu)
add_executable(reduce src/Reduce.cu)
add_executable(normalize src/normalize.cu)
add_executable(sobel src/sobel.cu)
# add_executable(tvmgen src/tvm_codegen/fused_matmul_main.cu src/tvm_codegen/block_fuse_d2l_matmul_kernel0 /tmp/mmult_kernel0.cu)
add_executable(cudnn_conv src/cudnn_conv.cu)
add_executable(lstm_wavefront_main src/lstm/lstm_main.cu src/lstm/lstm_wavefront_magic.cu src/lstm/seq2seq.cu)
add_executable(lstm_wavefront_timesteps src/lstm/lstm_wavefront_timesteps.cu) 
# set_target_properties(lstm_wavefront_magic PROPERTIES CUDA_ARCHITECTURES "70;75;80")
target_link_libraries(cudnn_conv cudnn)
# set_target_properties(tvmgen PROPERTIES CUDA_ARCHITECTURES "70;75;80")
